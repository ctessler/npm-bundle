\begin{algorithm}[H]
  \caption{Threads-Per-Job (\tpj{})}\label{alg:tpj}
  \begin{algorithmic}[1]
    \State \slack{\Deadline{0}} ${\gets \infty}$
    \For{${k \in \{D_1, D_2, D_3, ..., \}}$} \label{line:begin-for}
      \If{${D_k > T^*(\tasks)}$} \label{line:infeasible-1}
        \State return \emph{feasible}
      \EndIf
 
      \For {${\ant{j} \in \{\task{i} \in \tasks{} ~|~ (d_i = D_k)\}}$}      \label{line:bnc-mod-start}
      \If{${\slack{\Deadline{k-1}} < \hat{c}_j(1)}$}\label{line:minq-start}
        \State return \emph{infeasible} \label{line:no-slack-infease}
        \EndIf \label{line:minq-end}
      \State ${\Partial{j} \gets \{\ant{j}\}}$
      \If{${\slack{\Deadline{k-1}} < \hat{c}_j(\hat{m}_j)}$}\label{line:rem-p1}
        \Comment Jobs must be divided
          \State ${\Partial{j} \gets \algdivide{\ant{j}}{\slack{\Deadline{k-1}}}}$
          \label{line:divide}
          \State ${\tasks{} \gets \tasks{} \setminus \ant{j}}$
          \Comment Anterior task \ant{j} is represented by \Partial{j}
          \State ${\tasks{} \gets \tasks{} \cup \Partial{j}}$
          \Comment Partial tasks include all threads of \ant{j}
      \EndIf \label{line:rem-p2}
      \For {${\task{j} \in \Partial{j}}$}
          \State ${q_j \gets \wcet{j}{m_j}}$
      \EndFor
      \EndFor \label{line:the-same}
      \label{line:bnc-mod-end}
      
      \State \slack{${D_k}$} ${\gets \min
        \left(
          \slack{${D_{k-1}}$}, D_k - \sum_{\task{i} \in \tasks}
          \dbf{\task{i}}{${D_k}$}
        \right)
      }$ \label{line:same-deadline}
      \If{\slack{${D_k}$} ${< 0}$} \label{line:infeasible-2}
        \State return \emph{infeasible} \label{line:more-demand}
      \EndIf
    \EndFor
  \end{algorithmic}
\end{algorithm}
